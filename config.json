{
  "schemas": {
    "memories": {
      "type": "object",
      "properties": {
        "memories": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "enum": ["code", "llm"] },
              "title": { "type": "string", "description": "2-8 word summary of body" },
              "body": { "type": "string" },
              "priority": { "type": "string", "enum": ["low", "medium", "high"] },
              "rationale": { "type": "string" },
              "sources": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": { "quote": { "type": "string" } },
                  "required": ["quote"],
                  "additionalProperties": false
                }
              }
            },
            "required": ["type", "title", "body", "priority", "rationale", "sources"],
            "additionalProperties": false
          }
        }
      },
      "required": ["memories"],
      "additionalProperties": false
    },
    "edits": {
      "type": "object",
      "properties": {
        "edits": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "type": "object",
                "properties": {
                  "edit": { "type": "string", "const": "delete" },
                  "ids": { "type": "array", "items": { "type": "string" }, "minItems": 1 },
                  "reason": { "type": "string" }
                },
                "required": ["edit", "ids", "reason"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "edit": { "type": "string", "const": "merge" },
                  "ids": { "type": "array", "items": { "type": "string" }, "minItems": 2 },
                  "type": { "type": "string", "enum": ["code", "llm"] },
                  "title": { "type": "string", "description": "2-8 word summary of body" },
                  "body": { "type": "string", "description": "Merge .body of merged items" },
                  "priority": {
                    "type": "string",
                    "enum": ["low", "medium", "high"]
                  },
                  "rationale": { "type": "string", "description": "Merge .rationale of merged items" },
                  "reason": { "type": "string", "description": "Explain reason for merging" }
                },
                "required": ["edit", "ids", "type", "title", "body", "priority", "rationale", "reason"],
                "additionalProperties": false
              }
            ]
          }
        }
      },
      "required": ["edits"],
      "additionalProperties": false
    }
  }
}
